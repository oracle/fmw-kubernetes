<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.74.3" />
    <meta name="description" content="Create or update an Oracle WebCenter Sites Docker image used for deploying Oracle WebCenter Sites domains. An Oracle WebCenter Sites Docker image can be created using the WebLogic Image Tool or using the Dockerfile approach.">


    <link rel="icon" href="/fmw-kubernetes/21.1.1/images/favicon.png" type="image/png">

    <title>Create or update an image :: Oracle Fusion Middleware on Kubernetes</title>

    
    <link href="/fmw-kubernetes/21.1.1/css/nucleus.css?1612461268" rel="stylesheet">
    <link href="/fmw-kubernetes/21.1.1/css/fontawesome-all.min.css?1612461268" rel="stylesheet">
    <link href="/fmw-kubernetes/21.1.1/css/hybrid.css?1612461268" rel="stylesheet">
    <link href="/fmw-kubernetes/21.1.1/css/featherlight.min.css?1612461268" rel="stylesheet">
    <link href="/fmw-kubernetes/21.1.1/css/perfect-scrollbar.min.css?1612461268" rel="stylesheet">
    <link href="/fmw-kubernetes/21.1.1/css/auto-complete.css?1612461268" rel="stylesheet">
    <link href="/fmw-kubernetes/21.1.1/css/atom-one-dark-reasonable.css?1612461268" rel="stylesheet">
    <link href="/fmw-kubernetes/21.1.1/css/theme.css?1612461268" rel="stylesheet">
    <link href="/fmw-kubernetes/21.1.1/css/hugo-theme.css?1612461268" rel="stylesheet">
    

    <script src="/fmw-kubernetes/21.1.1/js/jquery-3.3.1.min.js?1612461268"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/fmw-kubernetes/21.1.1/wcsites-domains/create-or-update-image/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="/fmw-kubernetes/21.1.1/">
  <img src="/fmw-kubernetes/21.1.1//images/fmw_12c_12_2_1_4_0-logo.png" height="100"><br/>
  <b>Oracle Fusion Middleware on Kubernetes </b>
</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/fmw-kubernetes/21.1.1/js/lunr.min.js?1612461268"></script>
<script type="text/javascript" src="/fmw-kubernetes/21.1.1/js/auto-complete.js?1612461268"></script>
<script type="text/javascript">
    
        var baseurl = "\/fmw-kubernetes\/21.1.1\/";
    
</script>
<script type="text/javascript" src="/fmw-kubernetes/21.1.1/js/search.js?1612461268"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">
        <li><a  class="" href="/fmw-kubernetes/">Home</a></li>
        
          
          


 
  
    
    <li data-nav-id="/fmw-kubernetes/21.1.1/wcsites-domains/" title="Oracle WebCenter Sites" class="dd-item 
        parent
        
        
        ">
      <a href="/fmw-kubernetes/21.1.1/wcsites-domains/">
          Oracle WebCenter Sites
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/fmw-kubernetes/21.1.1/wcsites-domains/release-notes/" title="Release Notes" class="dd-item ">
        <a href="/fmw-kubernetes/21.1.1/wcsites-domains/release-notes/">
        <b>1. </b>Release Notes
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/fmw-kubernetes/21.1.1/wcsites-domains/installguide/" title="Install Guide" class="dd-item 
        
        
        
        ">
      <a href="/fmw-kubernetes/21.1.1/wcsites-domains/installguide/">
          <b>2. </b>Install Guide
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/fmw-kubernetes/21.1.1/wcsites-domains/installguide/prerequisites/" title="Requirements and limitations" class="dd-item 
        
        
        
        ">
      <a href="/fmw-kubernetes/21.1.1/wcsites-domains/installguide/prerequisites/">
          <b>  </b>Requirements and limitations
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/fmw-kubernetes/21.1.1/wcsites-domains/installguide/prepare-your-environment/" title="Prepare your environment" class="dd-item 
        
        
        
        ">
      <a href="/fmw-kubernetes/21.1.1/wcsites-domains/installguide/prepare-your-environment/">
          <b>  </b>Prepare your environment
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/fmw-kubernetes/21.1.1/wcsites-domains/installguide/create-wcsites-domains/" title="Create Oracle WebCenter Sites domains" class="dd-item 
        
        
        
        ">
      <a href="/fmw-kubernetes/21.1.1/wcsites-domains/installguide/create-wcsites-domains/">
          <b>  </b>Create Oracle WebCenter Sites domains
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/fmw-kubernetes/21.1.1/wcsites-domains/adminguide/" title="Administration Guide" class="dd-item 
        
        
        
        ">
      <a href="/fmw-kubernetes/21.1.1/wcsites-domains/adminguide/">
          <b>3.  </b>Administration Guide
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/fmw-kubernetes/21.1.1/wcsites-domains/adminguide/configure-load-balancer/" title="Set up a load balancer" class="dd-item 
        
        
        
        ">
      <a href="/fmw-kubernetes/21.1.1/wcsites-domains/adminguide/configure-load-balancer/">
          <b> </b>Set up a load balancer
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/fmw-kubernetes/21.1.1/wcsites-domains/adminguide/configure-load-balancer/traefik/" title="Traefik" class="dd-item ">
        <a href="/fmw-kubernetes/21.1.1/wcsites-domains/adminguide/configure-load-balancer/traefik/">
        <b>a. </b>Traefik
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/fmw-kubernetes/21.1.1/wcsites-domains/adminguide/configure-load-balancer/nginx/" title="NGINX" class="dd-item ">
        <a href="/fmw-kubernetes/21.1.1/wcsites-domains/adminguide/configure-load-balancer/nginx/">
        <b>b. </b>NGINX
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/fmw-kubernetes/21.1.1/wcsites-domains/adminguide/configure-load-balancer/voyager/" title="Voyager" class="dd-item ">
        <a href="/fmw-kubernetes/21.1.1/wcsites-domains/adminguide/configure-load-balancer/voyager/">
        <b>c. </b>Voyager
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/fmw-kubernetes/21.1.1/wcsites-domains/adminguide/monitoring-wcsites-domains/" title="Monitor a domain and publish logs" class="dd-item ">
        <a href="/fmw-kubernetes/21.1.1/wcsites-domains/adminguide/monitoring-wcsites-domains/">
        <b> </b>Monitor a domain and publish logs
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/fmw-kubernetes/21.1.1/wcsites-domains/adminguide/elasticsearch-integration/" title="Elasticsearch integration for logs" class="dd-item ">
        <a href="/fmw-kubernetes/21.1.1/wcsites-domains/adminguide/elasticsearch-integration/">
        <b> </b>Elasticsearch integration for logs
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/fmw-kubernetes/21.1.1/wcsites-domains/adminguide/weblogic-logging-exporter-setup/" title="Publish logs to Elasticsearch" class="dd-item ">
        <a href="/fmw-kubernetes/21.1.1/wcsites-domains/adminguide/weblogic-logging-exporter-setup/">
        <b> </b>Publish logs to Elasticsearch
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/fmw-kubernetes/21.1.1/wcsites-domains/patch-and-upgrade/" title="Upgrade and Patch " class="dd-item 
        
        
        
        ">
      <a href="/fmw-kubernetes/21.1.1/wcsites-domains/patch-and-upgrade/">
          <b>4. </b>Upgrade and Patch 
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/fmw-kubernetes/21.1.1/wcsites-domains/patch-and-upgrade/patch-an-image/patch-wcsites-product-image/" title="Patch a Oracle WebCenter Sites product Docker image" class="dd-item ">
        <a href="/fmw-kubernetes/21.1.1/wcsites-domains/patch-and-upgrade/patch-an-image/patch-wcsites-product-image/">
        <b>a. </b>Patch a Oracle WebCenter Sites product Docker image
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/fmw-kubernetes/21.1.1/wcsites-domains/patch-and-upgrade/upgrade-operator-release/" title="Upgrade an operator release" class="dd-item ">
        <a href="/fmw-kubernetes/21.1.1/wcsites-domains/patch-and-upgrade/upgrade-operator-release/">
        <b>b. </b>Upgrade an operator release
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/fmw-kubernetes/21.1.1/wcsites-domains/patch-and-upgrade/upgrade-k8s-cluster/" title="Upgrade a Kubernetes cluster" class="dd-item ">
        <a href="/fmw-kubernetes/21.1.1/wcsites-domains/patch-and-upgrade/upgrade-k8s-cluster/">
        <b>c. </b>Upgrade a Kubernetes cluster
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/fmw-kubernetes/21.1.1/wcsites-domains/create-or-update-image/" title="Create or update an image" class="dd-item 
        parent
        active
        
        ">
      <a href="/fmw-kubernetes/21.1.1/wcsites-domains/create-or-update-image/">
          <b>5. </b>Create or update an image
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/fmw-kubernetes/21.1.1/wcsites-domains/cleanup-domain-setup/" title="Uninstall" class="dd-item ">
        <a href="/fmw-kubernetes/21.1.1/wcsites-domains/cleanup-domain-setup/">
        <b>5. </b>Uninstall
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/fmw-kubernetes/21.1.1/wcsites-domains/oracle-cloud/" title="Oracle Cloud Infrastructure" class="dd-item 
        
        
        
        ">
      <a href="/fmw-kubernetes/21.1.1/wcsites-domains/oracle-cloud/">
          <b>6. </b>Oracle Cloud Infrastructure
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/fmw-kubernetes/21.1.1/wcsites-domains/oracle-cloud/oke/" title="Preparing an OKE environment" class="dd-item ">
        <a href="/fmw-kubernetes/21.1.1/wcsites-domains/oracle-cloud/oke/">
        <b>a. </b>Preparing an OKE environment
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/fmw-kubernetes/21.1.1/wcsites-domains/oracle-cloud/bastion/" title="Preparing the Bastion host" class="dd-item ">
        <a href="/fmw-kubernetes/21.1.1/wcsites-domains/oracle-cloud/bastion/">
        <b>b. </b>Preparing the Bastion host
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/fmw-kubernetes/21.1.1/wcsites-domains/oracle-cloud/filesystem/" title="Preparing a file system" class="dd-item ">
        <a href="/fmw-kubernetes/21.1.1/wcsites-domains/oracle-cloud/filesystem/">
        <b>c. </b>Preparing a file system
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/fmw-kubernetes/21.1.1/wcsites-domains/oracle-cloud/ocir/" title="Creating an OCIR" class="dd-item ">
        <a href="/fmw-kubernetes/21.1.1/wcsites-domains/oracle-cloud/ocir/">
        <b>d. </b>Creating an OCIR
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/fmw-kubernetes/21.1.1/wcsites-domains/faq/" title="Frequently Asked Questions" class="dd-item ">
        <a href="/fmw-kubernetes/21.1.1/wcsites-domains/faq/">
        <b>7. </b>Frequently Asked Questions
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/fmw-kubernetes/21.1.1/wcsites-domains/appendix/" title="Appendix" class="dd-item 
        
        
        
        ">
      <a href="/fmw-kubernetes/21.1.1/wcsites-domains/appendix/">
          <b>8. </b>Appendix
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/fmw-kubernetes/21.1.1/wcsites-domains/appendix/wcsites-cluster-sizing-info/" title="Domain resource sizing" class="dd-item ">
        <a href="/fmw-kubernetes/21.1.1/wcsites-domains/appendix/wcsites-cluster-sizing-info/">
        <b> </b>Domain resource sizing
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/fmw-kubernetes/21.1.1/wcsites-domains/appendix/quickstart-deployment-on-prem/" title="Quick start deployment on-premise" class="dd-item ">
        <a href="/fmw-kubernetes/21.1.1/wcsites-domains/appendix/quickstart-deployment-on-prem/">
        <b> </b>Quick start deployment on-premise
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/fmw-kubernetes/21.1.1/wcsites-domains/appendix/docker-k8s-hardening/" title="Security hardening" class="dd-item ">
        <a href="/fmw-kubernetes/21.1.1/wcsites-domains/appendix/docker-k8s-hardening/">
        <b> </b>Security hardening
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    

    
    <section id="footer">
      <p>Created with <i class="fas fa-heart"></i> from <a href="https://www.oracle.com">Oracle</a></p>
<p>&nbsp;</p>
<p><a href="https://github.com/oracle/fmw-kubernetes"><i class="fab fa-github"></i> GitHub repo</a></p>


    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/fmw-kubernetes/21.1.1/'>Oracle Fusion Middleware on Kubernetes</a> > <a href='/fmw-kubernetes/21.1.1/wcsites-domains/'>Oracle WebCenter Sites</a> > Create or update an image
          
         
          
         
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#create-or-update-an-oracle-webcenter-sites-docker-image-using-the-weblogic-image-tool">Create or update an Oracle WebCenter Sites Docker image using the WebLogic Image Tool</a></li>
        <li><a href="#create-an-oracle-webcenter-sites-docker-image-using-dockerfile">Create an Oracle WebCenter Sites Docker image using Dockerfile</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Create or update an image
            </h1>
          

        




	<p>If you have access to the My Oracle Support (MOS), and there is a need to build a new image with a patch (bundle or interim), it is recommended to use the WebLogic Image Tool to build an Oracle WebCenter Sites image for production deployments.</p>
<ul>
<li><a href="#create-or-update-an-oracle-wcsites-suite-docker-image-using-the-weblogic-image-tool">Create or update an Oracle WebCenter Sites Docker image using the WebLogic Image Tool</a>
<ul>
<li><a href="#set-up-the-weblogic-image-tool">Set up the WebLogic Image Tool</a></li>
<li><a href="#create-an-image">Create an image</a></li>
<li><a href="#update-an-image">Update an image</a></li>
</ul>
</li>
<li><a href="#create-an-oracle-wcsites-suite-docker-image-using-dockerfile">Create an Oracle WebCenter Sites Docker image using Dockerfile</a></li>
</ul>
<h3 id="create-or-update-an-oracle-webcenter-sites-docker-image-using-the-weblogic-image-tool">Create or update an Oracle WebCenter Sites Docker image using the WebLogic Image Tool</h3>
<p>Using the WebLogic Image Tool, you can <a href="/fmw-kubernetes/21.1.1/wcsites-domains/create-or-update-image/#create-an-image">create</a> a new Oracle WebCenter Sites Docker image (can include patches as well) or <a href="/fmw-kubernetes/21.1.1/wcsites-domains/create-or-update-image/#update-an-image">update</a> an existing image with one or more patches (bundle patch and interim patches).</p>
<blockquote>
<p><strong>Recommendations:</strong></p>
<ul>
<li>Use <a href="/fmw-kubernetes/21.1.1/wcsites-domains/create-or-update-image/#create-an-image">create</a> for creating a new Oracle WebCenter Sites Docker image either:
<ul>
<li>without any patches</li>
<li>or, containing the Oracle WebCenter Sites binaries, bundle patch and interim patches. This is the recommended approach if you have access to the Oracle WebCenter Sites patches because it optimizes the size of the image.</li>
</ul>
</li>
<li>Use <a href="/fmw-kubernetes/21.1.1/wcsites-domains/create-or-update-image/#update-an-image">update</a> for patching an existing Oracle WebCenter Sites Docker image with a single interim patch. Note that the patched image size may increase considerably due to additional image layers introduced by the patch application tool.</li>
</ul>
</blockquote>
<h4 id="set-up-the-weblogic-image-tool">Set up the WebLogic Image Tool</h4>
<ul>
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#set-up-the-weblogic-image-tool">Set up the WebLogic Image Tool</a></li>
<li><a href="#validate-setup">Validate setup</a></li>
<li><a href="#weblogic-image-tool-build-directory">WebLogic Image Tool build directory</a></li>
<li><a href="#weblogic-image-tool-cache">WebLogic Image Tool cache</a></li>
<li><a href="#set-up-additional-build-scripts">Set up additional build scripts</a></li>
</ul>
<h5 id="prerequisites">Prerequisites</h5>
<p>Verify that your environment meets the following prerequisites:</p>
<ul>
<li>Docker client and daemon on the build machine, with minimum Docker version 18.03.1.ce.</li>
<li>Bash version 4.0 or later, to enable the <!-- raw HTML omitted --> command complete feature.</li>
<li>JAVA_HOME environment variable set to the appropriate JDK location.</li>
</ul>
<h5 id="set-up-the-weblogic-image-tool-1">Set up the WebLogic Image Tool</h5>
<p>To set up the WebLogic Image Tool:</p>
<ol>
<li>
<p>Create a working directory and change to it. In these steps, this directory is <code>imagetool-setup</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ mkdir imagetool-setup
$ cd imagetool-setup
</code></pre></div></li>
<li>
<p>Download the latest version of the WebLogic Image Tool from the <a href="https://github.com/oracle/weblogic-image-tool/releases/latest">releases page</a>.</p>
</li>
<li>
<p>Unzip the release ZIP file to the <code>imagetool-setup</code> directory.</p>
</li>
<li>
<p>Execute the following commands to set up the WebLogic Image Tool on a Linux environment:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ cd imagetool-setup/imagetool/bin
$ source setup.sh
</code></pre></div></li>
</ol>
<h5 id="validate-setup">Validate setup</h5>
<p>To validate the setup of the WebLogic Image Tool:</p>
<ol>
<li>
<p>Enter the following command to retrieve the version of the WebLogic Image Tool:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ imagetool --version
</code></pre></div></li>
<li>
<p>Enter <code>imagetool</code> then press the Tab key to display the available <code>imagetool</code> commands:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ imagetool &lt;TAB&gt;
cache   create  help    rebase  update
</code></pre></div></li>
</ol>
<h5 id="weblogic-image-tool-build-directory">WebLogic Image Tool build directory</h5>
<p>The WebLogic Image Tool creates a temporary Docker context directory, prefixed by <code>wlsimgbuilder_temp</code>, every time the tool runs. Under normal circumstances, this context directory will be deleted. However, if the process is aborted or the tool is unable to remove the directory, it is safe for you to delete it manually. By default, the WebLogic Image Tool creates the Docker context directory under the user&rsquo;s home directory. If you prefer to use a different directory for the temporary context, set the environment variable <code>WLSIMG_BLDDIR</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ export WLSIMG_BLDDIR<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/path/to/buid/dir&#34;</span>
</code></pre></div><h5 id="weblogic-image-tool-cache">WebLogic Image Tool cache</h5>
<p>The WebLogic Image Tool maintains a local file cache store. This store is used to look up where the Java, WebLogic Server installers, and WebLogic Server patches reside in the local file system. By default, the cache store is located in the user&rsquo;s <code>$HOME/cache</code> directory. Under this directory, the lookup information is stored in the <code>.metadata</code> file. All automatically downloaded patches also reside in this directory. You can change the default cache store location by setting the environment variable <code>WLSIMG_CACHEDIR</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ export WLSIMG_CACHEDIR<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/path/to/cachedir&#34;</span>
</code></pre></div><h5 id="set-up-additional-build-scripts">Set up additional build scripts</h5>
<p>Creating an Oracle WebCenter Sites Docker image using the WebLogic Image Tool requires additional container scripts for Oracle WebCenter Sites domains.</p>
<ol>
<li>
<p>Clone the <a href="https://github.com/oracle/docker-images.git">docker-images</a> repository to set up those scripts. In these steps, this directory is <code>DOCKER_REPO</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ cd imagetool-setup
$ git clone https://github.com/oracle/docker-images.git
</code></pre></div></li>
<li>
<p>Copy the additional WebLogic Image Tool build files from the operator source repository to the <code>imagetool-setup</code> location:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ mkdir -p imagetool-setup/docker-images/OracleWebCenterSites/imagetool/12.2.1.4
$ cd imagetool-setup/docker-images/OracleWebCenterSites/imagetool/12.2.1.4
$ cp -rf <span style="color:#e6db74">${</span>WORKDIR<span style="color:#e6db74">}</span>/weblogic-kubernetes-operator/kubernetes/samples/scripts/imagetool-scripts/* .
</code></pre></div></li>
</ol>
<h4 id="create-an-image">Create an image</h4>
<p>After <a href="/fmw-kubernetes/21.1.1/wcsites-domains/create-or-update-image/#set-up-the-weblogic-image-tool">setting up the WebLogic Image Tool</a> and required build scripts, follow these steps to use the WebLogic Image Tool to <code>create</code> a new Oracle WebCenter Sites Docker image.</p>
<h5 id="preparing-response-files">Preparing response files</h5>
<ol>
<li>Add INSTALL_TYPE=&quot;WebLogic Server&rdquo; in %path-to-downloaded-docker-repo%/OracleFMWInfrastructure/dockerfiles/12.2.1.4/install.file</li>
<li>Rename %path-to-downloaded-docker-repo%/OracleWebCenterSites/dockerfiles/12.2.1.4/install.file to %path-to-downloaded-docker-repo%/OracleWebCenterSites/dockerfiles/12.2.1.4/wcs.file</li>
</ol>
<h5 id="create-a-wcs-wls-docker-install-installer">Create a wcs-wls-docker-install installer</h5>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ cd %path-to-downloaded-docker-repo%/OracleWebCenterSites/dockerfiles/12.2.1.4/wcs-wls-docker-install
$ docker run --rm -u root -v <span style="color:#e6db74">${</span>PWD<span style="color:#e6db74">}</span>:/wcs-wls-docker-install groovy:2.4.8-jdk8 /wcs-wls-docker-install/packagejar.sh

</code></pre></div><h5 id="download-the-oracle-webcenter-sites-installation-binaries-and-patches">Download the Oracle WebCenter Sites installation binaries and patches</h5>
<p>You must download the required Oracle WebCenter Sites installation binaries and patches as listed below from the <a href="https://edelivery.oracle.com/">Oracle Software Delivery Cloud</a> and save them in a directory of your choice. In these steps, this directory is <code>download location</code>.</p>
<p>Following is the list of installation binaries and patches required for 21.1.1 release:</p>
<ul>
<li>
<p>JDK:</p>
<ul>
<li>jdk-8u241-linux-x64.tar.gz</li>
</ul>
</li>
<li>
<p>Fusion MiddleWare Infrastructure installer:</p>
<ul>
<li>fmw_12.2.1.4.0_infrastructure.jar</li>
</ul>
</li>
<li>
<p>Fusion MiddleWare Infrastructure patches:</p>
<ul>
<li>p28186730_139424_Generic.zip (Opatch)</li>
<li>p31537019_122140_Generic.zip (WLS)</li>
<li>p30729380_122140_Generic.zip (COH)</li>
</ul>
</li>
<li>
<p>WCS installers:</p>
<ul>
<li>fmw_12.2.1.4.0_wcsites.jar</li>
</ul>
</li>
<li>
<p>WCS patches:</p>
<ul>
<li>p32315127_122140_Generic.zip (WCS)</li>
</ul>
</li>
</ul>
<h5 id="update-required-build-files">Update required build files</h5>
<p>The following files available in the code repository location <code>${WORKDIR}/weblogic-kubernetes-operator/kubernetes/samples/scripts/imagetool-scripts</code> are used for creating the image.</p>
<ul>
<li><code>additionalBuildCmds.txt</code></li>
<li><code>buildArgs</code></li>
</ul>
<ol>
<li>
<p>In the <code>buildArgs</code> file, update all the occurrences of <code>%DOCKER_REPO%</code> with the repository location, which is the complete path of <code>imagetool-setup</code>.</p>
<p>For example, update:</p>
<p><code>%DOCKER_REPO%/OracleWebCenterSites/kubernetes/imagetool-scripts/</code></p>
</li>
<li>
<p>Similarly, update the placeholders <code>%JDK_VERSION%</code> and <code>%BUILDTAG%</code> with appropriate values.</p>
</li>
</ol>
<h5 id="create-the-image">Create the image</h5>
<ol>
<li>
<p>Add a JDK package to the WebLogic Image Tool cache:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ imagetool cache addInstaller --type jdk --version 8u241 --path &lt;download location&gt;/jdk-8u241-linux-x64.tar.gz
</code></pre></div></li>
<li>
<p>Add the downloaded installation binaries to the WebLogic Image Tool cache:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ imagetool cache addInstaller --type fmw --version 12.2.1.4.0 --path &lt;download location&gt;/fmw_12.2.1.4.0_infrastructure.jar

$ imagetool cache addInstaller --type wcs --version 12.2.1.4.0 --path &lt;download location&gt;/fmw_12.2.1.4.0_wcsites.jar

</code></pre></div></li>
<li>
<p>Add the downloaded patches to the WebLogic Image Tool cache:</p>

<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fas fa-chevron-down' : 'fas fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fas fa-chevron-right"></i>
        <span>
        
    	
    	Click here to see the commands to add patches in to the cache:
    	
    	</span>
    </div>
    <div class="expand-content" style="display: none;">
        <pre><code>``` bash
$ imagetool cache addEntry --key 28186730_13.9.4.2.4 --value &lt;download location&gt;/p28186730_139424_Generic.zip

$ imagetool cache addEntry --key 31537019_12.2.1.4.0 --value &lt;download location&gt;/p31537019_122140_Generic.zip

$ imagetool cache addEntry --key 30729380_12.2.1.4.0 --value &lt;download location&gt;/p30729380_122140_Generic.zip

$ imagetool cache addEntry --key 32315127_12.2.1.4.0 --value &lt;download location&gt;/p32315127_122140_Generic.zip


```
</code></pre>

    </div>
</div>
</li>
<li>
<p>Update the patches list to <code>buildArgs</code>.</p>
<p>To the <code>create</code> command in the <code>buildArgs</code> file, append the Oracle WebCenter Sites patches list using the <code>--patches</code> flag and Opatch patch using the <code>--opatchBugNumber</code> flag. Sample options for the list of patches above are:</p>
<pre><code>--patches 31537019_12.2.1.4.0,30729380_12.2.1.4.0,p32315127_12.2.1.4.0
--opatchBugNumber=28186730_13.9.4.2.4

</code></pre><p>Example <code>buildArgs</code> file after appending product&rsquo;s list of patches and Opatch patch:</p>
<pre><code>create
--jdkVersion=8u241
--type WCS
--version=12.2.1.4
--tag=oracle/wcsites:12.2.1.4-21.1.1
--installerResponseFile %path-to-downloaded-docker-repo%/OracleWebCenterSites/dockerfiles/12.2.1.4/wcs.file,%path-to-downloaded-docker-repo%/OracleWebCenterSites/dockerfiles/12.2.1.4/install.file
--additionalBuildCommands %path-to-downloaded-fmw-kubernetes%/OracleWebCenterSites/kubernetes/imagetool-scripts/addtionalBuildCmds.txt --additionalBuildFiles %path-to-downloaded-docker-repo%/OracleWebCenterSites/dockerfiles/12.2.1.4/sites-container-scripts,%path-to-downloaded-docker-repo%/OracleWebCenterSites/dockerfiles/12.2.1.4/wcs-wls-docker-install
--patches 31537019_12.2.1.4.0,30729380_12.2.1.4.0,32315127_12.2.1.4.0
--opatchBugNumber=28186730_13.9.4.2.4

</code></pre><p>Refer to <a href="https://github.com/oracle/weblogic-image-tool/blob/master/site/create-image.md">this page</a> for the complete list of options available with the WebLogic Image Tool <code>create</code> command.</p>
</li>
<li>
<p>Enter the following command to create the Oracle WebCenter Sites image:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ imagetool @&lt;absolute path to <span style="color:#e6db74">`</span>buildargs<span style="color:#e6db74">`</span> file&gt;<span style="color:#e6db74">&#34;
</span></code></pre></div>
<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fas fa-chevron-down' : 'fas fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fas fa-chevron-right"></i>
        <span>
        
    	
    	Click here to see the sample Dockerfile generated with the imagetool command.
    	
    	</span>
    </div>
    <div class="expand-content" style="display: none;">
        <pre><code>  ```bash
  ########## BEGIN DOCKERFILE ##########
  #
  # Copyright (c) 2019, 2020, Oracle and/or its affiliates.
  #
  # Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.
  #
  #
  FROM oraclelinux:7-slim as OS_UPDATE
  LABEL com.oracle.weblogic.imagetool.buildid=&quot;3b37c045-11c6-4eb8-b69c-f42256c1e082&quot;
  USER root

  RUN yum -y --downloaddir= install gzip tar unzip libaio \
   &amp;&amp; yum -y --downloaddir= clean all \
   &amp;&amp; rm -rf /var/cache/yum/* \
   &amp;&amp; rm -rf 

  ## Create user and group
  RUN if [ -z &quot;$(getent group oracle)&quot; ]; then hash groupadd &amp;&gt; /dev/null &amp;&amp; groupadd oracle || exit -1 ; fi \
   &amp;&amp; if [ -z &quot;$(getent passwd oracle)&quot; ]; then hash useradd &amp;&gt; /dev/null &amp;&amp; useradd -g oracle oracle || exit -1; fi \
   &amp;&amp; mkdir /u01 \
   &amp;&amp; chown oracle:oracle /u01

  # Install Java
  FROM OS_UPDATE as JDK_BUILD
  LABEL com.oracle.weblogic.imagetool.buildid=&quot;3b37c045-11c6-4eb8-b69c-f42256c1e082&quot;

  ENV JAVA_HOME=/u01/jdk

  COPY --chown=oracle:oracle jdk-8u251-linux-x64.tar.gz /tmp/imagetool/

  USER oracle


  RUN tar xzf /tmp/imagetool/jdk-8u251-linux-x64.tar.gz -C /u01 \
   &amp;&amp; mv /u01/jdk* /u01/jdk \
   &amp;&amp; rm -rf /tmp/imagetool


  # Install Middleware
  FROM OS_UPDATE as WLS_BUILD
  LABEL com.oracle.weblogic.imagetool.buildid=&quot;3b37c045-11c6-4eb8-b69c-f42256c1e082&quot;

  ENV JAVA_HOME=/u01/jdk \
      ORACLE_HOME=/u01/oracle \
      OPATCH_NO_FUSER=true

  RUN mkdir -p /u01/oracle \
   &amp;&amp; mkdir -p /u01/oracle/oraInventory \
   &amp;&amp; chown oracle:oracle /u01/oracle/oraInventory \
   &amp;&amp; chown oracle:oracle /u01/oracle

  COPY --from=JDK_BUILD --chown=oracle:oracle /u01/jdk /u01/jdk/

  COPY --chown=oracle:oracle fmw_12.2.1.4.0_infrastructure.jar install.file /tmp/imagetool/
  COPY --chown=oracle:oracle fmw_12.2.1.4.0_wcsites.jar wcs.file /tmp/imagetool/
  COPY --chown=oracle:oracle oraInst.loc /u01/oracle/

      COPY --chown=oracle:oracle p28186730_139422_Generic.zip /tmp/imagetool/opatch/

      COPY --chown=oracle:oracle patches/* /tmp/imagetool/patches/

  USER oracle


  RUN  \
   /u01/jdk/bin/java -Xmx1024m -jar /tmp/imagetool/fmw_12.2.1.4.0_infrastructure.jar -silent ORACLE_HOME=/u01/oracle \
      -responseFile /tmp/imagetool/install.file -invPtrLoc /u01/oracle/oraInst.loc -ignoreSysPrereqs -force -novalidation
  RUN  \
   /u01/jdk/bin/java -Xmx1024m -jar /tmp/imagetool/fmw_12.2.1.4.0_wcsites.jar -silent ORACLE_HOME=/u01/oracle \
      -responseFile /tmp/imagetool/wcs.file -invPtrLoc /u01/oracle/oraInst.loc -ignoreSysPrereqs -force -novalidation

  RUN cd /tmp/imagetool/opatch \
   &amp;&amp; /u01/jdk/bin/jar -xf /tmp/imagetool/opatch/p28186730_139422_Generic.zip \
   &amp;&amp; /u01/jdk/bin/java -jar /tmp/imagetool/opatch/6880880/opatch_generic.jar -silent -ignoreSysPrereqs -force -novalidation oracle_home=/u01/oracle

  RUN /u01/oracle/OPatch/opatch napply -silent -oh /u01/oracle -phBaseDir /tmp/imagetool/patches \
   &amp;&amp; /u01/oracle/OPatch/opatch util cleanup -silent -oh /u01/oracle



  FROM OS_UPDATE as FINAL_BUILD

  ARG ADMIN_NAME
  ARG ADMIN_HOST
  ARG ADMIN_PORT
  ARG MANAGED_SERVER_PORT

  ENV ORACLE_HOME=/u01/oracle \
      JAVA_HOME=/u01/jdk \
      LC_ALL=${DEFAULT_LOCALE:-en_US.UTF-8} \
      PATH=${PATH}:/u01/jdk/bin:/u01/oracle/oracle_common/common/bin:/u01/oracle/wlserver/common/bin:/u01/oracle

  LABEL com.oracle.weblogic.imagetool.buildid=&quot;3b37c045-11c6-4eb8-b69c-f42256c1e082&quot;

      COPY --from=JDK_BUILD --chown=oracle:oracle /u01/jdk /u01/jdk/

  COPY --from=WLS_BUILD --chown=oracle:oracle /u01/oracle /u01/oracle/



  USER oracle
  WORKDIR /u01/oracle

  #ENTRYPOINT /bin/bash

      
      USER root
      
      COPY --chown=oracle:oracle files/sites-container-scripts/overrides/oui/ /u01/oracle/wcsites/common/templates/wls/
      
      USER oracle
        
      RUN cd /u01/oracle/wcsites/common/templates/wls &amp;&amp; \
        $JAVA_HOME/bin/jar uvf oracle.wcsites.base.template.jar startup-plan.xml file-definition.xml &amp;&amp; \
        rm /u01/oracle/wcsites/common/templates/wls/startup-plan.xml &amp;&amp; \
        rm /u01/oracle/wcsites/common/templates/wls/file-definition.xml
      
      #
      # Install the required packages
      # -----------------------------
      USER root
      ENV SITES_CONTAINER_SCRIPTS=/u01/oracle/sites-container-scripts \
        SITES_INSTALLER_PKG=wcs-wls-docker-install \
        DOMAIN_ROOT=&quot;${DOMAIN_ROOT:-/u01/oracle/user_projects/domains}&quot; \
        ADMIN_PORT=7001 \
        WCSITES_PORT=7002 \
        ADMIN_SSL_PORT=9001 \
        WCSITES_SSL_PORT=9002 \
          PATH=$PATH:/u01/oracle/sites-container-scripts
        
      RUN yum install -y hostname &amp;&amp; \
          rm -rf /var/cache/yum
      
      RUN mkdir -p ${SITES_CONTAINER_SCRIPTS} &amp;&amp; \
        mkdir -p /u01/wcs-wls-docker-install 
      COPY --chown=oracle:oracle  files/sites-container-scripts/ ${SITES_CONTAINER_SCRIPTS}/
      COPY --chown=oracle:oracle  files/wcs-wls-docker-install/ /u01/wcs-wls-docker-install/
      
      RUN chown oracle:oracle -R /u01/oracle/sites-container-scripts &amp;&amp; \
        chown oracle:oracle -R /u01/wcs-wls-docker-install &amp;&amp; \
        chmod a+xr /u01/oracle/sites-container-scripts/* &amp;&amp; \
        chmod a+xr /u01/wcs-wls-docker-install/*.sh
      
      # Expose all Ports
      # -------------------------------------------------------------
      EXPOSE $ADMIN_PORT $ADMIN_SSL_PORT $WCSITES_PORT $WCSITES_SSL_PORT
      
      USER oracle
      WORKDIR ${ORACLE_HOME}
      # Define default command to start.
      # -------------------------------------------------------------
      CMD [&quot;/u01/oracle/sites-container-scripts/createOrStartSitesDomain.sh&quot;]
      
      

  ########## END DOCKERFILE ##########

  ```
</code></pre>

    </div>
</div>
</li>
<li>
<p>Check the created image using the <code>Docker images</code> command:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">  $ docker images | grep wcsites
</code></pre></div></li>
</ol>
<h4 id="update-an-image">Update an image</h4>
<p>After <a href="/fmw-kubernetes/21.1.1/wcsites-domains/create-or-update-image/#set-up-the-weblogic-image-tool">setting up the WebLogic Image Tool</a> and required build scripts, use the WebLogic Image Tool to <code>update</code> an existing Oracle WebCenter Sites Docker image:</p>
<ol>
<li>
<p>Enter the following command for each patch to add the required patch(es) to the WebLogic Image Tool cache:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$  cd &lt;imagetool-setup&gt;
$ imagetool cache addEntry --key 32315127_12.2.1.4.0 --value &lt; %path-to-downloaded-pathes%/patches/p32315127_122140_Generic.zip
  <span style="color:#f92672">[</span>INFO   <span style="color:#f92672">]</span> Added entry 32315127_12.2.1.4.0<span style="color:#f92672">=</span>&lt; %path-to-downloaded-pathes%/patches/p32315127_122140_Generic.zip
</code></pre></div></li>
<li>
<p>Provide the following arguments to the WebLogic Image Tool <code>update</code> command:</p>
<ul>
<li><code>–-fromImage</code> - Identify the image that needs to be updated. In the example below, the image to be updated is <code>oracle/wcsites:12.2.1.4-21.1.1</code>.</li>
<li><code>–-patches</code> - Multiple patches can be specified as a comma-separated list.</li>
<li><code>--tag</code> - Specify the new tag to be applied for the image being built.</li>
</ul>
<p>Refer <a href="https://github.com/oracle/weblogic-image-tool/blob/master/site/update-image.md">here</a> for the complete list of options available with the WebLogic Image Tool <code>update</code> command.</p>
<blockquote>
<p>Note: The WebLogic Image Tool cache should have the latest OPatch zip. The WebLogic Image Tool will update the OPatch if it is not already updated in the image.</p>
</blockquote>
<h5 id="examples">Examples</h5>

<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fas fa-chevron-down' : 'fas fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fas fa-chevron-right"></i>
        <span>
        
    	
    	Click here to see the example `update` command:
    	
    	</span>
    </div>
    <div class="expand-content" style="display: none;">
        <pre><code>$ imagetool update --fromImage oracle/wcsites:12.2.1.4-21.1.1 --tag=oracle/wcsites:12.2.1.4-21.1.1-32315127 --patches=32315127_12.2.1.4.0

    [INFO   ] Image Tool build ID: 7c268a9a-723f-424e-a06e-cb615c783e6d
    [INFO   ] Temporary directory used for docker build context: %path-to-temp-directory%/tmpBuild/wlsimgbuilder_temp8555048225669509
    [INFO   ] Using patch 28186730_13.9.4.2.4 from cache: %path-to-downloaded-pathes%/patches
/p28186730_139424_Generic.zip
    [INFO   ] OPatch will not be updated, fromImage has version 13.9.4.2.4, available version is 13.9.4.2.4
    [WARNING] skipping patch conflict check, no support credentials provided
    [WARNING] No credentials provided, skipping validation of patches
    [INFO   ] Using patch 32315127_12.2.1.4.0 from cache:  %path-to-downloaded-pathes%/patches
/p32315127_122140_Generic.zip
    [INFO   ] docker cmd = docker build --no-cache --force-rm --tag oracle/wcsites:12.2.1.4-21.1.1 --build-arg http_proxy=http://www-proxy-your-company.com:80 --build-arg https_proxy=http://www-proxy-your-company.com:80 --build-arg no_proxy=localhost,127.0.0.0/8,/var/run/docker.sock %path-to-temp-directory%/tmpBuild/wlsimgbuilder_temp8555048225669509
    Sending build context to Docker daemon  212.7MB

    Step 1/7 : FROM oracle/wcsites:12.2.1.4-21.1.1 as FINAL_BUILD
     ---&gt; 480f1a31c02b
    Step 2/7 : USER root
     ---&gt; Running in 9d5a81ad5bde
    Removing intermediate container 9d5a81ad5bde
     ---&gt; 71b50b0b34dc
    Step 3/7 : ENV OPATCH_NO_FUSER=true
     ---&gt; Running in c361884e8a71
    Removing intermediate container c361884e8a71
     ---&gt; 2951de256951
    Step 4/7 : LABEL com.oracle.weblogic.imagetool.buildid=&quot;7c268a9a-723f-424e-a06e-cb615c783e6d&quot;
     ---&gt; Running in e2f485ac9039
    Removing intermediate container e2f485ac9039
     ---&gt; 970f6552ef9a
    Step 5/7 : USER oracle
     ---&gt; Running in e3c85228af4b
    Removing intermediate container e3c85228af4b
     ---&gt; 4401fdb4ebbe
    Step 6/7 : COPY --chown=oracle:oracle patches/* /tmp/imagetool/patches/
     ---&gt; 978a48e1cc95
    Step 7/7 : RUN /u01/oracle/OPatch/opatch napply -silent -oh /u01/oracle -phBaseDir /tmp/imagetool/patches     &amp;&amp; /u01/oracle/OPatch/opatch util cleanup -silent -oh /u01/oracle     &amp;&amp; rm -rf /tmp/imagetool
     ---&gt; Running in 5039320b2f10
    Oracle Interim Patch Installer version 13.9.4.2.4
    Copyright (c) 2020, Oracle Corporation.  All rights reserved.


    Oracle Home       : /u01/oracle
    Central Inventory : /u01/oracle/oraInventory
       from           : /u01/oracle/oraInst.loc
    OPatch version    : 13.9.4.2.4
    OUI version       : 13.9.4.0.0
    Log file location : /u01/oracle/cfgtoollogs/opatch/opatch2020-08-04_05-15-38AM_1.log


    OPatch detects the Middleware Home as &quot;/u01/oracle&quot;

    Verifying environment and performing prerequisite checks...
    OPatch continues with these patches:   32315127  

    Do you want to proceed? [y|n]
    Y (auto-answered by -silent)
    User Responded with: Y
    All checks passed.

    Please shutdown Oracle instances running out of this ORACLE_HOME on the local system.
    (Oracle Home = '/u01/oracle')


    Is the local system ready for patching? [y|n]
    Y (auto-answered by -silent)
    User Responded with: Y
    Backing up files...
    Applying interim patch '32315127' to OH '/u01/oracle'
    ApplySession: Optional component(s) [ oracle.wcsites.wccintegration, 12.2.1.4.0 ] , [ oracle.wcsites.wccintegration, 12.2.1.4.0 ]  not present in the Oracle Home or a higher version is found.

    Patching component oracle.wcsites, 12.2.1.4.0...

    Patching component oracle.wcsites, 12.2.1.4.0...

    Patching component oracle.wcsites.visitorservices, 12.2.1.4.0...

    Patching component oracle.wcsites.visitorservices, 12.2.1.4.0...

    Patching component oracle.wcsites.examples, 12.2.1.4.0...

    Patching component oracle.wcsites.examples, 12.2.1.4.0...

    Patching component oracle.wcsites.developer.tools, 12.2.1.4.0...

    Patching component oracle.wcsites.developer.tools, 12.2.1.4.0...

    Patching component oracle.wcsites.satelliteserver, 12.2.1.4.0...

    Patching component oracle.wcsites.satelliteserver, 12.2.1.4.0...

    Patching component oracle.wcsites.sitecapture, 12.2.1.4.0...

    Patching component oracle.wcsites.sitecapture, 12.2.1.4.0...
    Patch 32315127 successfully applied.
    Log file location: /u01/oracle/cfgtoollogs/opatch/opatch2020-08-04_05-15-38AM_1.log

    OPatch succeeded.
    Oracle Interim Patch Installer version 13.9.4.2.4
    Copyright (c) 2020, Oracle Corporation.  All rights reserved.


    Oracle Home       : /u01/oracle
    Central Inventory : /u01/oracle/oraInventory
       from           : /u01/oracle/oraInst.loc
    OPatch version    : 13.9.4.2.4
    OUI version       : 13.9.4.0.0
    Log file location : /u01/oracle/cfgtoollogs/opatch/opatch2020-08-04_05-16-11AM_1.log


    OPatch detects the Middleware Home as &quot;/u01/oracle&quot;

    Invoking utility &quot;cleanup&quot;
    OPatch will clean up 'restore.sh,make.txt' files and 'scratch,backup' directories.
    You will be still able to rollback patches after this cleanup.
    Do you want to proceed? [y|n]
    Y (auto-answered by -silent)
    User Responded with: Y

    Backup area for restore has been cleaned up. For a complete list of files/directories
    deleted, Please refer log file.

    OPatch succeeded.
    Removing intermediate container 5039320b2f10
     ---&gt; 1be958e1e859
    Successfully built 1be958e1e859
    Successfully tagged oracle/wcsites:12.2.1.4-21.1.1-32315127
    [INFO   ] Build successful. Build time=73s. Image tag=oracle/wcsites:12.2.1.4-21.1.1-32315127

</code></pre>
    </div>
</div>

<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fas fa-chevron-down' : 'fas fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fas fa-chevron-right"></i>
        <span>
        
    	
    	Click here to see the example Dockerfile generated by the WebLogic Image Tool with the `–-dryRun` option:
    	
    	</span>
    </div>
    <div class="expand-content" style="display: none;">
        <div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ imagetool update --fromImage oracle/wcsites:12.2.1.4-21.1.1 --tag<span style="color:#f92672">=</span>oracle/wcsites:12.2.1.4-21.1.1-32315127 --patches<span style="color:#f92672">=</span>32315127_12.2.1.4.0 --dryRun

  <span style="color:#f92672">[</span>INFO   <span style="color:#f92672">]</span> Image Tool build ID: a2fca032-7807-4bfb-b5a4-0ed90a710a56
  <span style="color:#f92672">[</span>INFO   <span style="color:#f92672">]</span> Temporary directory used <span style="color:#66d9ef">for</span> docker build context: %path-to-temp-directory%/tmpBuild/wlsimgbuilder_temp4743247141639108603
  <span style="color:#f92672">[</span>INFO   <span style="color:#f92672">]</span> Using patch 28186730_13.9.4.2.4 from cache: %path-to-downloaded-pathes%/patches
/p28186730_139424_Generic.zip
  <span style="color:#f92672">[</span>INFO   <span style="color:#f92672">]</span> OPatch will not be updated, fromImage has version 13.9.4.2.4, available version is 13.9.4.2.4
  <span style="color:#f92672">[</span>WARNING<span style="color:#f92672">]</span> skipping patch conflict check, no support credentials provided
  <span style="color:#f92672">[</span>WARNING<span style="color:#f92672">]</span> No credentials provided, skipping validation of patches
  <span style="color:#f92672">[</span>INFO   <span style="color:#f92672">]</span> Using patch 32315127_12.2.1.4.0 from cache:  %path-to-downloaded-pathes%/patches
/p32315127_122140_Generic.zip
  <span style="color:#f92672">[</span>INFO   <span style="color:#f92672">]</span> docker cmd <span style="color:#f92672">=</span> docker build --no-cache --force-rm --tag oracle/wcsites:12.2.1.4-21.1.1.1 --build-arg http_proxy<span style="color:#f92672">=</span>http://www-proxy-your-company.com:80 --build-arg https_proxy<span style="color:#f92672">=</span>http://www-proxy-your-company.com:80 --build-arg no_proxy<span style="color:#f92672">=</span>localhost,127.0.0.0/8,/var/run/docker.sock %path-to-temp-directory%/tmpBuild/wlsimgbuilder_temp4743247141639108603
  <span style="color:#75715e">########## BEGIN DOCKERFILE ##########</span>
  #
  <span style="color:#75715e"># Copyright (c) 2019, 2020, Oracle and/or its affiliates.</span>
  #
  <span style="color:#75715e"># Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.</span>
  #
  #

  FROM oracle/wcsites:12.2.1.4-21.1.1 as FINAL_BUILD
  USER root

  ENV OPATCH_NO_FUSER<span style="color:#f92672">=</span>true


  LABEL com.oracle.weblogic.imagetool.buildid<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;a2fca032-7807-4bfb-b5a4-0ed90a710a56&#34;</span>

  USER oracle


      COPY --chown<span style="color:#f92672">=</span>oracle:oracle patches/* /tmp/imagetool/patches/

      RUN /u01/oracle/OPatch/opatch napply -silent -oh /u01/oracle -phBaseDir /tmp/imagetool/patches <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>      <span style="color:#f92672">&amp;&amp;</span> /u01/oracle/OPatch/opatch util cleanup -silent -oh /u01/oracle <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>      <span style="color:#f92672">&amp;&amp;</span> rm -rf /tmp/imagetool




  <span style="color:#75715e">########## END DOCKERFILE ##########</span>
  <span style="color:#f92672">[</span>INFO   <span style="color:#f92672">]</span> Dry run complete.  No image created.

</code></pre></div>
    </div>
</div>
</li>
<li>
<p>Check the built image using the <code>Docker images</code> command:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">  $ docker images | grep wcsites
  oracle/wcsites   12.2.1.4-21.1.1-32315127   2ef2a67a685b        About a minute ago   2.84GB
  oracle/wcsites   12.2.1.4-21.1.1            445b649a3459        <span style="color:#ae81ff">4</span> days ago           3.2GB

</code></pre></div></li>
</ol>
<h3 id="create-an-oracle-webcenter-sites-docker-image-using-dockerfile">Create an Oracle WebCenter Sites Docker image using Dockerfile</h3>
<p>For test and development purposes, you can create an Oracle WebCenter Sites image using the Dockerfile. Consult the <a href="https://github.com/oracle/docker-images/blob/master/OracleWebCenterSites/dockerfiles/README.md">README</a> file for important prerequisite steps,
such as building or pulling the Server JRE Docker image, Oracle FMW Infrastructure Docker image, and downloading the Oracle WebCenter Sites installer and bundle patch binaries.</p>
<p>A prebuilt Oracle Fusion Middleware Infrastructure image, <code>container-registry.oracle.com/middleware/fmw-infrastructure:12.2.1.4</code>, is available at <code>container-registry.oracle.com</code>. We recommend that you pull and rename this image to build the Oracle WebCenter Sites image.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">  $ docker pull &lt;path-to-container-registry&gt;/fmw-infrastructure:12.2.1.4
  $ docker tag &lt;path-to-container-registry&gt;/fmw-infrastructure:12.2.1.4  oracle/fmw-infrastructure:12.2.1.4
</code></pre></div><p>Follow these steps to build an Oracle Fusion Middleware Infrastructure image, and then the Oracle WebCenter Sites image as a layer on top of that:</p>
<ol>
<li>
<p>Make a local clone of the sample repository:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ git clone https://github.com/oracle/docker-images
</code></pre></div></li>
<li>
<p>Build the <code>oracle/fmw-infrastructure:12.2.1.4</code> image:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"> $ cd docker-images/OracleFMWInfrastructure/dockerfiles
 $ sh buildDockerImage.sh -v 12.2.1.4 -s
</code></pre></div><p>This will produce an image named <code>oracle/fmw-infrastructure:12.2.1.4</code>.</p>
</li>
<li>
<p>Download the Oracle WebCenter Sites installer from the Oracle Technology Network or e-delivery.</p>
<blockquote>
<p>Note: Copy the installer binaries to the same location as the Dockerfile.</p>
</blockquote>
</li>
<li>
<p>To build the Oracle WebCenter Sites image with patches, you must download and drop the patch zip files (for example, <code>p32315127_122140_Generic.zip</code>) into the <code>patches/</code> folder under the version that is required. For example, for <code>12.2.1.4</code> the folder is <code>12.2.1.4/patches</code>.</p>
</li>
<li>
<p>Create the Oracle WebCenter Sites image by running the provided script:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ cd docker-images/OracleWebCenterSites/dockerfiles
$ ./buildDockerImage.sh -v 12.2.1.4 -s
</code></pre></div><p>The image produced will be named <code>oracle/wcsites:12.2.1.4</code>. The samples and instructions assume the Oracle WebCenter Sites image is named <code>wcsites:12.2.1.4</code>. You must rename your image to match this name, or update the samples to refer to the image you created.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ docker tag oracle/wcsites:12.2.1.4 oracle/wcsites:12.2.1.4-21.1.1 
</code></pre></div></li>
</ol>





<footer class=" footline" >
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/fmw-kubernetes/21.1.1/wcsites-domains/patch-and-upgrade/upgrade-k8s-cluster/" title="Upgrade a Kubernetes cluster"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/fmw-kubernetes/21.1.1/wcsites-domains/cleanup-domain-setup/" title="Uninstall" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/fmw-kubernetes/21.1.1/js/clipboard.min.js?1612461268"></script>
    <script src="/fmw-kubernetes/21.1.1/js/perfect-scrollbar.min.js?1612461268"></script>
    <script src="/fmw-kubernetes/21.1.1/js/perfect-scrollbar.jquery.min.js?1612461268"></script>
    <script src="/fmw-kubernetes/21.1.1/js/jquery.sticky.js?1612461268"></script>
    <script src="/fmw-kubernetes/21.1.1/js/featherlight.min.js?1612461268"></script>
    <script src="/fmw-kubernetes/21.1.1/js/highlight.pack.js?1612461268"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/fmw-kubernetes/21.1.1/js/modernizr.custom-3.6.0.js?1612461268"></script>
    <script src="/fmw-kubernetes/21.1.1/js/learn.js?1612461268"></script>
    <script src="/fmw-kubernetes/21.1.1/js/hugo-learn.js?1612461268"></script>

    <link href="/fmw-kubernetes/21.1.1/mermaid/mermaid.css?1612461268" rel="stylesheet" />
    <script src="/fmw-kubernetes/21.1.1/mermaid/mermaid.js?1612461268"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>
